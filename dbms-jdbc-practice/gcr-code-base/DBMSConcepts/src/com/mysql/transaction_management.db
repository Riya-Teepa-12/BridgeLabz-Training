/* Transaction Management
Implement a banking system with:
• Transfer money between accounts (use transactions)
• Check balance
• Transaction history
*/
use mypractice_db;
Database changed
mysql> CREATE TABLE accounts (
    ->     account_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     account_holder VARCHAR(100),
    ->     balance DECIMAL(10,2) NOT NULL
    -> );
Query OK, 0 rows affected (0.04 sec)

mysql> CREATE TABLE transactions (
    ->     transaction_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     from_account INT,
    ->     to_account INT,
    ->     amount DECIMAL(10,2),
    ->     transaction_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ->     transaction_type VARCHAR(50),
    ->
    ->     FOREIGN KEY (from_account) REFERENCES accounts(account_id),
    ->     FOREIGN KEY (to_account) REFERENCES accounts(account_id)
    -> );
Query OK, 0 rows affected (0.02 sec)

mysql> INSERT INTO accounts (account_holder, balance)
    -> VALUES
    -> ('Riya', 5000),
    -> ('Harshit', 3000);
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> SELECT account_holder, balance
    -> FROM accounts
    -> WHERE account_id = 1;
+----------------+---------+
| account_holder | balance |
+----------------+---------+
| Riya           | 5000.00 |
+----------------+---------+
1 row in set (0.00 sec)

mysql> START TRANSACTION;
Query OK, 0 rows affected (0.00 sec)

mysql>
mysql> -- Deduct from sender
mysql> UPDATE accounts
    -> SET balance = balance - 1000
    -> WHERE account_id = 1 AND balance >= 1000;
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql>
mysql> -- Add to receiver
mysql> UPDATE accounts
    -> SET balance = balance + 1000
    -> WHERE account_id = 2;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql>
mysql> -- Log transaction
mysql> INSERT INTO transactions
    -> (from_account, to_account, amount, transaction_type)
    -> VALUES
    -> (1, 2, 1000, 'TRANSFER');
Query OK, 1 row affected (0.00 sec)

mysql>
mysql> COMMIT;
Query OK, 0 rows affected (0.00 sec)

mysql> SELECT *
    -> FROM transactions
    -> WHERE from_account = 1 OR to_account = 1
    -> ORDER BY transaction_date DESC;
+----------------+--------------+------------+---------+---------------------+------------------+
| transaction_id | from_account | to_account | amount  | transaction_date    | transaction_type |
+----------------+--------------+------------+---------+---------------------+------------------+
|              1 |            1 |          2 | 1000.00 | 2026-02-09 14:29:21 | TRANSFER         |
+----------------+--------------+------------+---------+---------------------+------------------+
1 row in set (0.03 sec)

mysql> SELECT * FROM accounts;
+------------+----------------+---------+
| account_id | account_holder | balance |
+------------+----------------+---------+
|          1 | Riya           | 4000.00 |
|          2 | Harshit        | 4000.00 |
+------------+----------------+---------+
2 rows in set (0.00 sec)

mysql> SELECT * FROM transactions;
+----------------+--------------+------------+---------+---------------------+------------------+
| transaction_id | from_account | to_account | amount  | transaction_date    | transaction_type |
+----------------+--------------+------------+---------+---------------------+------------------+
|              1 |            1 |          2 | 1000.00 | 2026-02-09 14:29:21 | TRANSFER         |
+----------------+--------------+------------+---------+---------------------+------------------+
1 row in set (0.00 sec)