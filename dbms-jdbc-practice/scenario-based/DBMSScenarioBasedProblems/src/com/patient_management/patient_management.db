/* 1. Patient Management

UC-1.1: Register New Patient
Actor: Receptionist
Flow: Enter patient details (name, DOB, contact, address, blood group). System validates uniqueness by phone/email, generates patient ID, inserts record into patients table with auto-increment primary key.

UC-1.2: Update Patient Information
Actor: Receptionist
Flow: Search patient by ID/phone, display current details, update fields, execute SQL UPDATE with WHERE clause on patient ID.

UC-1.3: Search Patient Records
Actor: Receptionist/Doctor
Flow: Query patients table using LIKE operator for name search or exact match for ID/phone. Display results using ResultSet iteration.

UC-1.4: View Patient Visit History
Actor: Doctor/Receptionist
Flow: Execute JOIN query between appointments and visits tables filtered by patient ID. Display chronological list with doctor names and diagnoses.
*/

mysql> use  patient_management;
Database changed
mysql> CREATE TABLE patients (
    ->     patient_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     name VARCHAR(100) NOT NULL,
    ->     dob DATE NOT NULL,
    ->     phone VARCHAR(15) UNIQUE NOT NULL,
    ->     email VARCHAR(100) UNIQUE,
    ->     address TEXT,
    ->     blood_group VARCHAR(5)
    -> );
Query OK, 0 rows affected (0.02 sec)

mysql> CREATE TABLE doctors (
    ->     doctor_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     doctor_name VARCHAR(100) NOT NULL,
    ->     specialization VARCHAR(100),
    ->     contact VARCHAR(15)
    -> );
Query OK, 0 rows affected (0.01 sec)

mysql> CREATE TABLE appointments (
    ->     appointment_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     patient_id INT NOT NULL,
    ->     doctor_id INT NOT NULL,
    ->     appointment_date DATE NOT NULL,
    ->     appointment_time TIME,
    ->
    ->     FOREIGN KEY (patient_id) REFERENCES patients(patient_id),
    ->     FOREIGN KEY (doctor_id) REFERENCES doctors(doctor_id)
    -> );
Query OK, 0 rows affected (0.03 sec)

mysql> CREATE TABLE visits (
    ->     visit_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     patient_id INT NOT NULL,
    ->     doctor_id INT NOT NULL,
    ->     visit_date DATE NOT NULL,
    ->     diagnosis TEXT,
    ->     prescription TEXT,
    ->
    ->     FOREIGN KEY (patient_id) REFERENCES patients(patient_id),
    ->     FOREIGN KEY (doctor_id) REFERENCES doctors(doctor_id)
    -> );
Query OK, 0 rows affected (0.04 sec)

mysql> INSERT INTO patients
    -> (name, dob, phone, email, address, blood_group)
    -> VALUES
    -> ('Rahul Sharma', '1998-04-12', '9876543210', 'rahul@gmail.com', 'Delhi', 'O+'),
    -> ('Anita Verma', '1995-08-20', '9123456789', 'anita@gmail.com', 'Noida', 'A+');
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> INSERT INTO doctors
    -> (doctor_name, specialization, contact)
    -> VALUES
    -> ('Dr. Amit Kumar', 'Cardiology', '9998887776'),
    -> ('Dr. Neha Singh', 'Dermatology', '8887776665');
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> INSERT INTO appointments
    -> (patient_id, doctor_id, appointment_date, appointment_time)
    -> VALUES
    -> (1, 1, '2026-02-10', '10:30:00'),
    -> (2, 2, '2026-02-11', '11:00:00');
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> INSERT INTO visits
    -> (patient_id, doctor_id, visit_date, diagnosis, prescription)
    -> VALUES
    -> (1, 1, '2026-02-10', 'High BP', 'Low salt diet'),
    -> (2, 2, '2026-02-11', 'Skin Allergy', 'Antihistamine');
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> SELECT
    ->     p.name,
    ->     v.visit_date,
    ->     d.doctor_name,
    ->     v.diagnosis
    -> FROM visits v
    -> JOIN patients p ON v.patient_id = p.patient_id
    -> JOIN doctors d ON v.doctor_id = d.doctor_id
    -> WHERE p.patient_id = 1
    -> ORDER BY v.visit_date DESC;
+--------------+------------+----------------+-----------+
| name         | visit_date | doctor_name    | diagnosis |
+--------------+------------+----------------+-----------+
| Rahul Sharma | 2026-02-10 | Dr. Amit Kumar | High BP   |
+--------------+------------+----------------+-----------+
1 row in set (0.00 sec)

mysql>